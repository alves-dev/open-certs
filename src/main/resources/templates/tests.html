<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{base :: layout(
          title='Tests | OpenCerts',
          pageHeader='Testes',
          content=~{::content},
          styles=~{::styles},
          scripts=~{::scripts}
      )}">

<th:block th:fragment="styles">
    <style>
        /* Estilo base do card, assumindo que var(--color-surface) e outros existem */
        .test-card {
            background-color: var(--color-surface);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: flex; /* Usamos flex para alinhar o conteúdo e o botão */
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid var(--color-primary); /* Destaque lateral */
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .test-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

        /* Área de conteúdo e estatísticas */
        .test-content {
            flex-grow: 1;
        }

        .test-title {
            font-size: 1.35rem;
            color: var(--color-text);
            margin-bottom: 5px;
        }

        .test-subtitle {
            font-size: 0.95rem;
            color: var(--color-text-secondary);
            margin-bottom: 10px;
        }

        .test-stats {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .stat-item {
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Cores das estatísticas */
        .stat-correct {
            color: var(--color-success); /* Geralmente um verde */
        }

        .stat-error {
            color: var(--color-danger); /* Geralmente um vermelho */
        }

        .stat-percentage {
            font-weight: bold;
            color: var(--color-primary);
        }

        /* Botão */
        .btn-continue {
            background-color: var(--color-primary);
            color: white;
            padding: 10px 18px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.3s;
            margin-left: 20px; /* Espaço entre conteúdo e botão */
            flex-shrink: 0; /* Impede o botão de encolher */
        }

        .btn-continue:hover {
            background-color: #0056b3; /* Cor mais escura no hover */
        }

        /* Responsividade básica (em telas menores, o layout muda) */
        @media (max-width: 600px) {
            .test-card {
                flex-direction: column;
                align-items: flex-start;
            }
            .test-stats {
                flex-wrap: wrap;
                gap: 10px;
                margin-bottom: 15px;
            }
            .btn-continue {
                width: 100%;
                margin-left: 0;
                text-align: center;
            }
        }

    </style>
</th:block>

<th:block th:fragment="content">

<!--    <h1 style="color: var(&#45;&#45;color-text); margin-bottom: 25px; font-size: 1.8rem;">Minhas Sessões de Teste Salvas</h1>-->

    <div th:if="${testSessions == null or testSessions.isEmpty()}">
        <div class="card">
            <p>Você não tem nenhuma sessão de teste em aberto.</p>
            <p>Comece um novo teste na seção de Certificações disponíveis!</p>
        </div>
    </div>

    <div th:unless="${testSessions == null or testSessions.isEmpty()}">

        <!-- Itera sobre a lista de sessões de teste -->
        <div th:each="test : ${testSessions}" class="test-card">

            <!-- Conteúdo e Estatísticas (Lado Esquerdo) -->
            <div class="test-content">
                <!-- Identificador e Certificação -->
                <div class="test-title" th:text="${test.identifier}">aws-test-janeiro</div>
                <div class="test-subtitle">
                    Certificação: <strong th:text="${test.certification}">AWS - Cloud Practitioner</strong>
                    <br>Iniciado em: <span th:text="${#temporals.format(test.startedAt, 'dd/MM/yyyy HH:mm')}">15/11/2025 10:30</span>
                </div>

                <!-- Estatísticas de Progresso -->
                <div class="test-stats">
                    <span class="stat-item stat-percentage">
                        % of correct: <strong th:text="${test.percentageCorrect} + '%'">0%</strong>
                    </span>
                    <span class="stat-item stat-correct">
                        ✅ Acertos: <span th:text="${test.totalCorrect}">0</span>
                    </span>
                    <span class="stat-item stat-error">
                        ❌ Erros: <span th:text="${test.totalError}">0</span>
                    </span>
                </div>
            </div>

            <a th:href="@{/questions/{id}
                            (
                            id=${test.certification},
                            testIdentifier=${test.identifier}
                            )}" class="btn-continue"> continue test
            </a>

        </div>
    </div>

</th:block>

<th:block th:fragment="scripts">
    <script>
        console.log("Página testes carregada.");
    </script>
</th:block>
</html>